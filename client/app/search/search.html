<div ng-include="'components/navbar/navbar.html'"></div>

<div class="container-fluid" eui-index="'dig'">
  <div class="row"><!-- search panel + breadbox -->
    <div class="col-sm-12">       
      <div class="panel panel-default">
        <div class="panel-body">
        <div class="row">
          <div class="col-sm-5 bottom-pad10">
            <form ng-submit="submit()">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Search" eui-query="ejs.MatchQuery('_all', querystring)" ng-model="querystring" eui-enabled="querystring.length" />
              <span class="input-group-btn">
              <button class="btn btn-primary" type="submit"><i class="fa fa-search fa-lg"></i></button></span>
            </div>
            </form>
          </div>  
        </div>
        <!-- placeholder for breadbox (within panel?)-->
        </div>
      </div>
    </div>
  </div><!-- search panel + breadbox -->
  <div class="row" ng-show="showresults"><!-- sidebar and results -->
    <div class="col-md-3 sidebar">
      <form role="form">
      <div class="form-group">
        <label>Phone</label>
        <input type="text" eui-filter="ejs.TermsFilter('phonenumber', phone)" ng-model="phone" eui-enabled="phone.length">        
      </div>

      <div class="form-group">
        <label>City/Region</label>
        <ul eui-or-filter class="nav nav-list" eui-aggregation="ejs.TermsAggregation('city_agg').field('place_postalAddress').size(30)" eui-filter-self="false">
          <li ng-repeat="bucket in aggResult.buckets">
              <label class="checkbox" eui-filter="ejs.TermsFilter('place_postalAddress', bucket.key)">
              <input type="checkbox" ng-model="filter.enabled">{{bucket.key}} ({{bucket.doc_count}})
              </label>
          </li>
        </ul>
<!--         <input type="text" eui-filter="ejs.TermsFilter('place_postalAddress', city)" ng-model="city" eui-enabled="city.length">  -->       
      </div>

      <div class="form-group">
        <label>Hair Color</label>
        <ul eui-or-filter class="nav nav-list" eui-aggregation="ejs.TermsAggregation('hc_agg').field('person_haircolor').size(40)" eui-filter-self="false">
          <li ng-repeat="bucket in aggResult.buckets">
              <label class="checkbox" eui-filter="ejs.TermsFilter('person_haircolor', bucket.key)">
              <input type="checkbox" ng-model="filter.enabled">{{bucket.key}} ({{bucket.doc_count}})
              </label>
          </li>
        </ul>        
      </div> 
      </form>
    </div>

    <div class="col-md-8">
      <span><h3>Results: {{indexVM.results.hits.total}}</h3></span>
      <ul>
          <li ng-repeat="doc in indexVM.results.hits.hits">
              {{doc._source | json | limitTo: 500}} <!-- OPTIONAL: display more meaningful data instead of json -->
          </li>
      </ul>
      <div class="text-center">
        <pagination total-items="indexVM.results.hits.total" ng-model="indexVM.page" max-size="10" items-per-page="indexVM.pageSize" 
        class="pagination-sm" num-pages="indexVM.pageCount"></pagination>
        <p>Displaying page {{indexVM.page}} of {{indexVM.pageCount}}</p>
      </div>
    </div>
  </div><!-- sidebar and results -->

</div>

<footer class="footer">
</footer>
